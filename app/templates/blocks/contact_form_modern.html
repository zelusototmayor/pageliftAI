<!-- Modern Contact Form with Brand Integration -->
{% set has_phone = phone_number and phone_number != '#' %}
{% set has_email = email and email != '#' %}
{% set has_address = address and address != '#' %}
{% set primary_color = brand_identity.colors.primary or '#3B82F6' %}
{% set accent_color = brand_identity.colors.accent or '#F59E0B' %}

<section class="contact-section py-section-lg bg-gradient-to-b from-gray-50 to-white">
  <div class="container max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Section Header -->
    <div class="text-center mb-16">
      <div class="inline-flex items-center px-4 py-2 rounded-full text-sm font-semibold mb-6"
           style="background-color: {{ primary_color }}15; color: {{ primary_color }};">
        <div class="w-2 h-2 rounded-full mr-2" style="background-color: {{ primary_color }};"></div>
        Contact Us
      </div>
      <h2 class="text-4xl sm:text-5xl font-bold text-gray-900 mb-6">
        Ready to Get Started?
      </h2>
      <p class="text-xl text-gray-600 max-w-3xl mx-auto">
        Get in touch today for a free consultation and personalized quote for your project.
      </p>
    </div>
    
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-start">
      <!-- Contact Form -->
      <div class="bg-white rounded-2xl shadow-xl p-8 lg:p-10">
        <h3 class="text-2xl font-bold text-gray-900 mb-6">Send Us a Message</h3>
        
        <form action="/contact" method="POST" class="space-y-6" id="contact-form">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="name" class="block text-sm font-semibold text-gray-700 mb-2">
                Full Name *
              </label>
              <input 
                type="text" 
                id="name" 
                name="name" 
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:border-transparent touch-target transition-all duration-300"
                style="focus:ring-color: {{ primary_color }};"
                placeholder="Your full name">
            </div>
            
            <div>
              <label for="phone" class="block text-sm font-semibold text-gray-700 mb-2">
                Phone Number *
              </label>
              <input 
                type="tel" 
                id="phone" 
                name="phone" 
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:border-transparent touch-target transition-all duration-300"
                style="focus:ring-color: {{ primary_color }};"
                placeholder="(555) 123-4567">
            </div>
          </div>
          
          <div>
            <label for="email" class="block text-sm font-semibold text-gray-700 mb-2">
              Email Address *
            </label>
            <input 
              type="email" 
              id="email" 
              name="email" 
              required
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:border-transparent touch-target transition-all duration-300"
              style="focus:ring-color: {{ primary_color }};"
              placeholder="your.email@example.com">
          </div>
          
          <div>
            <label for="service" class="block text-sm font-semibold text-gray-700 mb-2">
              Service Needed
            </label>
            <select 
              id="service" 
              name="service"
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:border-transparent touch-target transition-all duration-300"
              style="focus:ring-color: {{ primary_color }};">
              <option value="">Select a service</option>
              {% if services %}
                {% for service in services[:8] %}
                  <option value="{{ service.name or service.title }}">
                    {{ service.name or service.title }}
                  </option>
                {% endfor %}
              {% else %}
                <option value="general">General Service</option>
                <option value="consultation">Free Consultation</option>
                <option value="quote">Get Quote</option>
              {% endif %}
            </select>
          </div>
          
          <div>
            <label for="message" class="block text-sm font-semibold text-gray-700 mb-2">
              Message *
            </label>
            <textarea 
              id="message" 
              name="message" 
              rows="5" 
              required
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:border-transparent resize-none touch-target transition-all duration-300"
              style="focus:ring-color: {{ primary_color }};"
              placeholder="Please describe your project or service needs..."></textarea>
          </div>
          
          <button 
            type="submit"
            class="w-full py-4 px-6 font-semibold rounded-xl text-white transition-all duration-300 transform hover:scale-105 hover:shadow-lg touch-target"
            style="background: linear-gradient(135deg, {{ primary_color }}, {{ accent_color }});">
            <span class="flex items-center justify-center">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"/>
                <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"/>
              </svg>
              Send Message
            </span>
          </button>
        </form>
      </div>
      
      <!-- Contact Information -->
      <div class="space-y-8">
        <!-- Direct Contact -->
        {% if has_phone %}
          <div class="bg-white rounded-2xl shadow-lg p-8">
            <div class="flex items-start">
              <div class="w-14 h-14 rounded-2xl flex items-center justify-center mr-6 flex-shrink-0"
                   style="background: linear-gradient(135deg, {{ primary_color }}15, {{ accent_color }}15);">
                <svg class="w-7 h-7" style="color: {{ primary_color }};" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"/>
                </svg>
              </div>
              <div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">Call Us Directly</h3>
                <p class="text-gray-600 mb-4">Speak with our team right away</p>
                <a href="tel:{{ phone_number }}" 
                   class="inline-flex items-center px-6 py-3 font-semibold rounded-xl transition-all duration-300 transform hover:scale-105 touch-target"
                   style="background: linear-gradient(135deg, {{ primary_color }}, {{ accent_color }}); color: white;">
                  {{ phone_number }}
                </a>
                {% if hours %}
                  <p class="text-sm text-gray-500 mt-3">{{ hours }}</p>
                {% endif %}
              </div>
            </div>
          </div>
        {% endif %}
        
        <!-- Email Contact -->
        {% if has_email %}
          <div class="bg-white rounded-2xl shadow-lg p-8">
            <div class="flex items-start">
              <div class="w-14 h-14 rounded-2xl flex items-center justify-center mr-6 flex-shrink-0"
                   style="background: linear-gradient(135deg, {{ primary_color }}15, {{ accent_color }}15);">
                <svg class="w-7 h-7" style="color: {{ primary_color }};" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"/>
                  <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"/>
                </svg>
              </div>
              <div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">Email Us</h3>
                <p class="text-gray-600 mb-4">Send us a detailed message</p>
                <a href="mailto:{{ email }}" 
                   class="text-blue-600 hover:text-blue-700 font-semibold transition-colors duration-300 touch-target break-all">
                  {{ email }}
                </a>
              </div>
            </div>
          </div>
        {% endif %}
        
        <!-- Location -->
        {% if has_address %}
          <div class="bg-white rounded-2xl shadow-lg p-8">
            <div class="flex items-start">
              <div class="w-14 h-14 rounded-2xl flex items-center justify-center mr-6 flex-shrink-0"
                   style="background: linear-gradient(135deg, {{ primary_color }}15, {{ accent_color }}15);">
                <svg class="w-7 h-7" style="color: {{ primary_color }};" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                </svg>
              </div>
              <div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">Visit Our Location</h3>
                <p class="text-gray-600 mb-4">Come see us in person</p>
                <address class="text-gray-700 not-italic">
                  {{ address }}
                </address>
              </div>
            </div>
          </div>
        {% endif %}
        
        <!-- Emergency Contact (if applicable) -->
        {% if '24' in (original_text or short_copy or '').lower() or 'emergency' in (original_text or short_copy or '').lower() %}
          <div class="bg-red-50 border-2 border-red-200 rounded-2xl p-8">
            <div class="flex items-start">
              <div class="w-14 h-14 bg-red-100 rounded-2xl flex items-center justify-center mr-6 flex-shrink-0">
                <svg class="w-7 h-7 text-red-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                </svg>
              </div>
              <div>
                <h3 class="text-xl font-bold text-red-900 mb-2">Emergency Service</h3>
                <p class="text-red-700 mb-4">Available 24/7 for urgent situations</p>
                {% if has_phone %}
                  <a href="tel:{{ phone_number }}" 
                     class="inline-flex items-center px-6 py-3 bg-red-600 text-white font-semibold rounded-xl hover:bg-red-700 transition-all duration-300 transform hover:scale-105 touch-target">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"/>
                    </svg>
                    Emergency Call
                  </a>
                {% endif %}
              </div>
            </div>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</section>

<style>
/* Form styling enhancements */
input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: {{ primary_color }};
  ring: 2px solid {{ primary_color }}33;
}

.touch-target {
  min-height: 44px;
  min-width: 44px;
}

@media (max-width: 1024px) {
  .grid {
    grid-template-columns: 1fr;
  }
}

/* Form validation styles */
input:invalid:not(:focus):not(:placeholder-shown),
textarea:invalid:not(:focus):not(:placeholder-shown) {
  border-color: #ef4444;
  background-color: #fef2f2;
}

input:valid:not(:placeholder-shown),
textarea:valid:not(:placeholder-shown) {
  border-color: #22c55e;
}
</style>

<script>
// Basic form validation and enhancement
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('contact-form');
  const inputs = form.querySelectorAll('input, textarea');
  
  // Add real-time validation
  inputs.forEach(input => {
    input.addEventListener('blur', function() {
      if (this.hasAttribute('required') && !this.value.trim()) {
        this.style.borderColor = '#ef4444';
        this.style.backgroundColor = '#fef2f2';
      } else if (this.value.trim()) {
        this.style.borderColor = '#22c55e';
        this.style.backgroundColor = '#f0fdf4';
      }
    });
    
    input.addEventListener('focus', function() {
      this.style.borderColor = '{{ primary_color }}';
      this.style.backgroundColor = 'white';
    });
  });
  
  // Form submission handling
  form.addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Basic validation
    let isValid = true;
    const requiredFields = form.querySelectorAll('[required]');
    
    requiredFields.forEach(field => {
      if (!field.value.trim()) {
        field.style.borderColor = '#ef4444';
        field.style.backgroundColor = '#fef2f2';
        isValid = false;
      }
    });
    
    if (isValid) {
      // You can implement actual form submission here
      alert('Thank you for your message! We will get back to you soon.');
    } else {
      alert('Please fill in all required fields.');
    }
  });
});
</script>